syntax = "proto3";

package proto;

option go_package = "bitbucket.stressedsharks.com/plat/proto";

/**
The <b>Keystore</b> holds private keys which can be requested via the GetPrivateKey API.  Requests are only allowed from authorized and authenicated clients by using tokens, client-based SSL certificates or both.

A new private key is created on the physical box where this service is running.  Typical clients of the keystore are the Signing Service and the Crypto Service who request their respective private keys upon startup.  This service does not need to be running at other times.
*/
service Keystore {
  // Returns an extended private key.
  rpc GetPrivateKey (GetPrivateKeyRequest) returns (GetPrivateKeyResponse) {}

  //Creates a new private key with the given alias
  rpc CreateAlias (CreateAliasRequest) returns (CreateAliasResponse) {}
}

message GetPrivateKeyRequest {
  string alias = 1; // The alias that represents the private key to use (must be less than 256 characters).
}

message GetPrivateKeyResponse {
  string extended_private_key = 1; // The extended private key in xpriv format (will be exactly 111 characters).
}

message CreateAliasRequest {
  string alias = 1; // The alias associated with the private key
}

message CreateAliasResponse {
}
